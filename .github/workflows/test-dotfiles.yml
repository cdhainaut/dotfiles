name: Test dotfiles deployment
on:
  push:
  pull_request:
jobs:
  docker-test:
    runs-on: ubuntu-latest
    timeout-minutes: 60
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4
      - name: Build test Docker image
        run: |
          docker build -t chezmoi-test .
      - name: Run container and apply chezmoi
        run: "docker run --rm -i chezmoi-test bash -c '\n  set -eux\n\n  # 1. Installer chezmoi\n  sh -c \"$(curl -fsLS get.chezmoi.io)\" -- -b \"$HOME/.local/bin\"\n  export PATH=\"$HOME/.local/bin:$PATH\"\n\n  # 2. Appliquer le dépôt\n  chezmoi init --apply github.com/${{ github.repository }}\n\n  # 3. Vérifications rapides pour éviter régressions\n  command -v zsh\n  command -v hx \n  command -v nvim\n  command -v cargo\n  command -v zellij || true   # selon ta conf\n'\n"
